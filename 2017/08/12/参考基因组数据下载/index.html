<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="https:/AnJingwd.github.io/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="https:/AnJingwd.github.io/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="https:/AnJingwd.github.io/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="NGS," />





  <link rel="alternate" href="https:/AnJingwd.github.io/atom.xml" title="安静-不安静的博客" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="https:/AnJingwd.github.io/favicon.ico?v=5.1.2" />






<meta name="description" content="&amp;emsp;&amp;emsp;常用到的基因组数据格式括:fasta,fastq,gff,GenBank format, EMBL format；常用的基因组数据库包括：（1）Ensembl基因组注释数据库；（2）UCUS基因组浏览器">
<meta name="keywords" content="NGS">
<meta property="og:type" content="article">
<meta property="og:title" content="基因组数据下载">
<meta property="og:url" content="https:///AnJingwd.github.io/2017/08/12/参考基因组数据下载/index.html">
<meta property="og:site_name" content="安静-不安静的博客">
<meta property="og:description" content="&amp;emsp;&amp;emsp;常用到的基因组数据格式括:fasta,fastq,gff,GenBank format, EMBL format；常用的基因组数据库包括：（1）Ensembl基因组注释数据库；（2）UCUS基因组浏览器">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://i.imgur.com/dAYlW8e.png">
<meta property="og:updated_time" content="2018-03-17T02:23:04.857Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基因组数据下载">
<meta name="twitter:description" content="&amp;emsp;&amp;emsp;常用到的基因组数据格式括:fasta,fastq,gff,GenBank format, EMBL format；常用的基因组数据库包括：（1）Ensembl基因组注释数据库；（2）UCUS基因组浏览器">
<meta name="twitter:image" content="http://i.imgur.com/dAYlW8e.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: 'https:///AnJingwd.github.io/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>







  <title>基因组数据下载 | 安静-不安静的博客</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="https:///AnJingwd.github.io/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">安静-不安静的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="https:/AnJingwd.github.io/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="https:/AnJingwd.github.io/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="https:/AnJingwd.github.io/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="https:/AnJingwd.github.io/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="https:/AnJingwd.github.io/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="https:/AnJingwd.github.io/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      

      
    </ul>
  

  
</nav>




 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https:///AnJingwd.github.iohttps:/AnJingwd.github.io/2017/08/12/参考基因组数据下载/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="AJ's blog">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https:/AnJingwd.github.io/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="安静-不安静的博客">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">基因组数据下载</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-12T17:15:06+08:00">
                2017-08-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="https:/AnJingwd.github.io/categories/NGS/" itemprop="url" rel="index">
                    <span itemprop="name">NGS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>&emsp;&emsp;常用到的基因组数据格式括:fasta,fastq,gff,GenBank format, EMBL format；常用的基因组数据库包括：（1）Ensembl基因组注释数据库；（2）UCUS基因组浏览器</p>
<a id="more"></a>
<p>&emsp;&emsp;常用到的基因组数据格式括:fasta,fastq,gff,GenBank format, EMBL format；常用的基因组数据库包括：（1）Ensembl基因组注释数据库；（2）UCUS基因组浏览器</p>
<h2 id="（1）通过Ensembl基因组注释数据库下载"><a href="#（1）通过Ensembl基因组注释数据库下载" class="headerlink" title="（1）通过Ensembl基因组注释数据库下载"></a>（1）通过Ensembl基因组注释数据库下载</h2><p>网址：<a href="http://www.ensembl.org/info/data/ftp/index.html" target="_blank" rel="external">http://www.ensembl.org/info/data/ftp/index.html</a></p>
<p><strong>下载数据前一定要仔细查看相应目录下的README文件</strong></p>
<p>上述网页链接都是最新版的，并且会随着基因组版本的更新而更新，历史版本可以在以下网址查询并下载：<a href="http://www.gencodegenes.org/releases/" target="_blank" rel="external">http://www.gencodegenes.org/releases/</a></p>
<p><strong>可以找到Ensembl来源的各个版本的基因注释GTF或者GFF3文件</strong></p>
<p> 其FTP site地址为：ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_human</p>
<table>
<thead>
<tr>
<th>Freeze date</th>
<th>GENCODE release</th>
<th>Ensembl release</th>
<th>Release date</th>
<th>Genome assembly version    </th>
</tr>
</thead>
<tbody>
<tr>
<td>01.2017</td>
<td><a href="http://www.gencodegenes.org/releases/27.html" target="_blank" rel="external">27</a></td>
<td><a href="http://aug2017.archive.ensembl.org/" target="_blank" rel="external">90</a></td>
<td>08.2017</td>
<td>GRCh38.p10</td>
</tr>
<tr>
<td>03.2016</td>
<td><a href="http://www.gencodegenes.org/releases/25.html" target="_blank" rel="external">25</a></td>
<td><a href="http://jul2016.archive.ensembl.org/" target="_blank" rel="external">85</a>, <a href="http://oct2016.archive.ensembl.org/" target="_blank" rel="external">86</a>, <a href="http://dec2016.archive.ensembl.org/" target="_blank" rel="external">87</a></td>
<td>07.2016</td>
<td>GRCh38.p7</td>
</tr>
</tbody>
</table>
<h3 id="基因组序列下载"><a href="#基因组序列下载" class="headerlink" title="基因组序列下载:"></a>基因组序列下载:</h3><p>&emsp;&emsp;Ensembl提供的参考基因组有2种组装形式和3种重复序列处理方式, 分别是primary, toplevel和unmasked (dna)、soft-masked (dna_sm)和masked (dna_rm)。一般选择dna.primary或dna_sm.primary。</p>
<ul>
<li>为什么选择Primary</li>
</ul>
<p>Primary assembly contains all toplevel sequence regions excluding haplotypes and patches. This file is best used for performing sequence similarity searcheswhere patch and haplotype sequences would confuse analysis.</p>
<p><strong>网页版的也为Primary Assembly版本的，例如Homo sapiens chromosome 7, GRCh38.p7 Primary Assembly</strong></p>
<ul>
<li>为什么不选择masked</li>
</ul>
<p>&emsp;&emsp;Masked基因组是指所有重复区和低复杂区被N代替的基因组序列，比对时就不会有reads比对到这些区域。一般不推荐用masked的基因组，因为它造成了信息的丢失，由此带来的一个问题是uniquely比对到masked基因组上的reads实际上可能不是unique的。而且masked基因组还会带来比对错误，使得在允许错配的情况下，本来来自重复区的reads比对到基因组的其它位置。 另外检测重复区和低复杂区的软件不可能是完美的，这就造成遮盖住的重复序列和低复杂区并不一定是100%准确和敏感的。</p>
<p>&emsp;&emsp;soft-masked基因组是指把所有重复区和低复杂区的序列用小写字母标出的基因组，由于主要的比对软件，比如BWA、bowtie2等都忽略这些soft-mask，直接把小写字母当做大写字母比对，所以使用soft-masked基因组的比对效果和使用unmasked基因组的比对效果是相同的。</p>
<p>(1)文件命名规则： \<species>.\<assembly>.\<sequence type="">.\<id type="">.\<id>.fa.gz</id></id></sequence></assembly></species></p>
<p>species:物种的名称</p>
<p>assembly:基因组的版本</p>
<p>sequence type（主要有三类）:</p>
<ul>
<li>‘dna’ - unmasked genomic DNA sequences.</li>
<li>‘dna_rm’ - masked genomic DNA.通过RepeatMasker软件 检测弥散的重复序列和低复杂度的区域，并将重复序列使用N替代。</li>
<li>‘dna_sm’ - soft-masked genomic DNA. 指Soft-masked的DNA序列，其中的重复序列和低复杂度的区域会用其相应碱基的小写字母来表示</li>
</ul>
<h3 id="举个栗子"><a href="#举个栗子" class="headerlink" title="举个栗子"></a>举个栗子</h3><p>（1）连续的N</p>
<pre><code>&gt;Homo_sapiens.GRCh38.dna_rm.chromosome.15.fa
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN
NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNTTAGAGACCTTGAGA
GGAATTAAACATCTCTGTGAGTATATGCTGTAGGGCTTTGCTGCACTGTCCTTGGAGGCT
</code></pre><p>（2）小写字母表示碱基</p>
<pre><code>&gt;Homo_sapiens.GRCh38.dna_sm.chromosome.X.fa
nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnctaaccctaaccctaaccct
aaccctaaccctaaccctctgaaagtggacctatcagcaggatgtgggtgggagcagatt
gacaacCCCTAGAAGAGCACCTGGTTGAtaacccagttcccatctgggatttaggggacc
aggggccctgggacagccctgtacatgagctcctggtctgtaacacagttcccctgtggg
gatttagggACTTGGGCCTTCTGTCTTTGGGATCTACTCTCTATGGGCCACACAGATATG
</code></pre><p>&emsp;&emsp;<strong>所以，使用RepeatMasker和Tandem Repeats Finder (with period of 12 or less)识别的重复在dna_rm中用大写的N表示，而在dna_sm中用小写字母表示，而非重复序列用大写字母表示。至于序列的开头和结尾，无论是dna_rm还是dna_sm，N/n表示（A,C,G,T）任意一种，也叫做Gaps，它意味着真实具体是哪一种碱基，测序平台不能确定，N/n的数目可能是不确定碱基数,都被一并maked掉了，在序列分析的时候并不会分析。</strong></p>
<h3 id="为什么要这样做呢？"><a href="#为什么要这样做呢？" class="headerlink" title="为什么要这样做呢？"></a>为什么要这样做呢？</h3><p>&emsp;&emsp;RepeatMasker是一款基于Library-based，通过相似性比对来识别重复序列，可以屏蔽序列中转座子重复序列和低复杂度序列（默认将其替换成N），几乎用于所有物种，是做基因组、非编码RNA的必备软件。<strong>在人类基因组分析当中，大约 56% 的序列会被mask；</strong> RepeatMasker在进行序列比对时可以选用常见的几种算法，包括nhmmer、cross_match、ABBlast/WUBlast、RMBlast 、Decypher（可以安装多个比对引擎，但每次只能使用其中一个）。</p>
<p>&emsp;&emsp;RepeatMasker应该是做已知repeat和TE的。基本原理是用已知repeats去blast。所以潜在的未知重复序列应该是无法用repeatmasker找到的，而在mRNA中的repeat序列也不应该用RepeatMasker找。<strong>repeatmasker的实际意义，就象这个软件的名字一样，是为了mask掉repeat。从而在查找基因，鉴定有功能的ncRNA，或者设计引物等提供一个精简的序列。毕竟用带有大量TE和repeat的序列做引物设计或者基因和蛋白功能分析，最后验证的时候只是得到了一批repeat</strong></p>
<p><strong>重复序列的种类：</strong></p>
<ul>
<li>Tandem repeats 串连重复<ul>
<li>Satellite DNA 卫星DNA</li>
<li>Variable number tandem repeat /Minisatellite 小卫星</li>
<li>Short tandem repeat（STR）/Microsatellite (Trinucleotide repeat disorders)微卫星</li>
</ul>
</li>
<li>Interspersed repeats 散落重复<ul>
<li>Transposon (Transposable elements (TEs) )转座子<ul>
<li>Retrotransposon 反转录转座子<ul>
<li>SINEs – Alu sequence, MIR 短散落元件</li>
<li>LINEs – LINE1, LINE2 长散落元件</li>
<li>LTRs – HERV, MER4, retroposon 长末端重复</li>
<li>DNA transposon DNA转座子</li>
<li>MER1, MER2, Mariners</li>
<li>TIR（Terminal Inverted Repeat） 末端方向重复</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Genomic island<ul>
<li>Genomic island</li>
</ul>
</li>
</ul>
<p>&emsp;&emsp;这种对RepeatMasker 和 Tandem Repeats Finder用小写表示的方式，可以用于UCSC的Genome Browser来展示重复序列。</p>
<p><img src="http://i.imgur.com/dAYlW8e.png" alt=""></p>
<p>id type: 可选值包括chromosome,nonchromosomal,seqlevel。</p>
<p>（1）chromosome就不用说了；</p>
<p>（2）nonchromosal中包含了暂时未能确定染色体的序列；</p>
<p>（3）seqlevel包括sequence scaffolds, chunks 或者clones三个层次。</p>
<ul>
<li>‘scaffold’：通过短的测序reads拼接组装成更大的序列—-contigs（通常来自全基因组鸟枪测序，WGS），但是还不能组成到染色体的程度。通常还需要更多的测序，来消除gaps并确定顺序（tiling path）</li>
<li>‘chunk’:当contigs序列能被组装成大的实体时，有时候必须认为的将其打断为更小的实体，称之为’chunks’。这是由于注释管道的限制并且受存储序列和注释信息的MySQL数据库的记录限制。</li>
<li>‘clone’ ：通常这是最小的序列实体。它经常与一个BAC clone或者部分区域的序列是一样的。</li>
</ul>
<p>id:实际序列的标示符，和\<id type="">对应</id></p>
<p>fa:表示文件格式为FASTA</p>
<p>gz:文件压缩方式为GUN Zip</p>
<p>toplevel文件中包含了所有的在ensembl数据库schema中被定义为toplevel的序列，包括染色体，未能组装到染色体上的区域以及含有N的haplotype/patch区域。 </p>
<p>primary_assembly文件相比于toplevel文件，减去了含有N的haplotype/patch区域。这类文件比较适合用来比对。</p>
<h3 id="除基因组注释文件（GTF或者GFF）下载"><a href="#除基因组注释文件（GTF或者GFF）下载" class="headerlink" title="除基因组注释文件（GTF或者GFF）下载"></a>除基因组注释文件（GTF或者GFF）下载</h3><p>&emsp;&emsp;例如在RNA-seq分析流程中，参考基因组序列用于reads的比对，而GTF或者GFF用于确定比对上的reads是否落在基因内，由此来相对定量基因的表达量，鉴定差异表达基因。</p>
<p>(1)文件命名规则：\<species>.\<assembly>.\<version>.gtf.gz</version></assembly></species></p>
<p>注释基因生物证据的比对（例如蛋白，cdna，RNA-seq）来组装基因组</p>
<p>对于预测的基因集：\<species>.\<assembly>.\<version>.abinitio.gtf.gz</version></assembly></species></p>
<p>这里的预测是指通过GenScan和其他的从头预测工具分析产生的基因。</p>
<h2 id="确定了需要下载什么后，那如何下载呢？"><a href="#确定了需要下载什么后，那如何下载呢？" class="headerlink" title="确定了需要下载什么后，那如何下载呢？"></a>确定了需要下载什么后，那如何下载呢？</h2><p>可以通过浏览器下载，但需要再上传到服务器；也可以通过之前介绍的多线程下载工具axel下载，速度很快。当然还可以使用ensembl提供的rsync工具下载。</p>
<h2 id="（2）通过UCSC下载基因组注释数据"><a href="#（2）通过UCSC下载基因组注释数据" class="headerlink" title="（2）通过UCSC下载基因组注释数据"></a>（2）通过UCSC下载基因组注释数据</h2><ul>
<li>Genome Browser’s “Table Browser”：</li>
</ul>
<p><a href="http://genome.ucsc.edu/cgi-bin/hgTables?command=start" target="_blank" rel="external">http://genome.ucsc.edu/cgi-bin/hgTables?command=start</a></p>
<ul>
<li>Bulk Downloads page：</li>
</ul>
<p><a href="http://hgdownload.cse.ucsc.edu/downloads.html" target="_blank" rel="external">http://hgdownload.cse.ucsc.edu/downloads.html</a></p>
<p>&emsp;&emsp;对于NGS的序列分析来说，如果没有reference genome和genome annotation下游的分析可能根本无法进行。UCSC提供的数据分为sequence和annotation两大类，对于人、小鼠在内的71种脊椎动物，可以从UCSC同时下载sequence和annotation，其他的一般只有sequence。</p>
<p><strong>基因组的版本：</strong></p>
<p>&emsp;&emsp;不同的生物信息学数据库对于基因组的命名方式各不相同。以人为例，NCBI/ENSEMBL用GRCh系列命名，而UCSC则使用hg系列命名。这两套命名系统背后的版本对应关系如下：</p>
<table>
<thead>
<tr>
<th>UCSC</th>
<th>NCBI</th>
</tr>
</thead>
<tbody>
<tr>
<td>hg18</td>
<td>GRCh36</td>
</tr>
<tr>
<td>hg19</td>
<td>GRCh37</td>
</tr>
<tr>
<td>hg38</td>
<td>GRCh38</td>
</tr>
</tbody>
</table>
<p><strong>hg系列和GRCh系列主要的差别有两处：</strong></p>
<p>（1）hg系列的染色体命名是”chr”+染色体号，而GRCh系列的染色体没有前缀的”chr”；</p>
<p>（2）hg系列序列是0-based（第一个核苷酸记0），GRCh系列是1-based（第一个核苷酸记1，两种计数方法的区别参见《基因组的坐标系统》）。</p>
<h2 id="（1）从FTP站点获取"><a href="#（1）从FTP站点获取" class="headerlink" title="（1）从FTP站点获取"></a>（1）从FTP站点获取</h2><ul>
<li>获取sequence</li>
</ul>
<p>UCSC的reference genome是分染色体保存的。</p>
<p>对于hg38来说，单个的染色体序列可以在以下网址下载：</p>
<p><a href="http://hgdownload.soe.ucsc.edu/goldenPath/hg38/chromosomes/" target="_blank" rel="external">http://hgdownload.soe.ucsc.edu/goldenPath/hg38/chromosomes/</a> </p>
<p>所有染色体打包好的文件在以下网址下载：</p>
<p><a href="http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.chromFa.tar.gz" target="_blank" rel="external">http://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/hg38.chromFa.tar.gz</a> </p>
<p>如果需要下载其他版本（19/18），可以把上述链接中的hg38换成hg19/hg18。如果需要将所有的染色体序列合并到一个文件中，可以在下载完成后依次执行下列命令（POSIX compatible）：</p>
<pre><code>tar –xzvf hg38.chromFa.tar.gz
cd hg38
cat *.fa &amp;gt; hg38.fa
</code></pre><ul>
<li>获取注释</li>
</ul>
<p>UCSC提供了SNP、RepeatMask、refSeq、GENCODE等注释文件。</p>
<p>但是在UCSC的FTP站点：</p>
<p><a href="http://hgdownload.soe.ucsc.edu/goldenPath/hg38/database" target="_blank" rel="external">http://hgdownload.soe.ucsc.edu/goldenPath/hg38/database</a></p>
<p>这些数据被分成了两个文件——一个是.sql结尾的SQL语句文件，描述了数据表的结构和创建数据表的方法；另一个是.txt.gz结尾的数据文件。我们可以通过.sql文件来查看表的结构，再把.txt.gz格式的文件解压后转换成所需要的格式。下面是将.txt.gz的数据文件转换成gtf格式的三个例子：</p>
<p>RepeatMask</p>
<pre><code>gunzip rmsk.txt.gz
gawk &apos;OFS=&quot;\t&quot;{print $6,&quot;rmsk &quot;,$12,$7+1,$8,&quot;.&quot;,$10,&quot;.&quot;,&quot; repName \&quot;&quot;$11&quot;\&quot;; repFamily \&quot;&quot;$13&quot;\&quot;;&quot;}&apos; rmsk.txt &amp;gt; rmsk.gtf
</code></pre><p>simpleRepeat</p>
<pre><code>gunzip simpleRepeat.txt.gz
gawk &apos;OFS=&quot;\t&quot;{print $2,&quot; simpleRepeat&quot;,&quot;trf&quot;,$3+1,$4,&quot;.&quot;,&quot;+&quot;,&quot;.&quot;,&quot;name \&quot;&quot;$5&quot;\&quot;; sequence \&quot;&quot;$17&quot;\&quot;;&quot;}&apos; simpleRepeat.txt &amp;gt; simpleRepeat.gtf
</code></pre><p>RefSeq</p>
<p>&emsp;&emsp;UCSC为RefSeq和GENCODE等以genePred形式保存的注释文件提供了专门的格式转换程序——genePredToBed、genePredToGenePred、genePredToFakePsl、genePredToGtf、genePredToMafFrames</p>
<p>各自的使用方法参见：</p>
<p><a href="http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/FOOTER" target="_blank" rel="external">http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/FOOTER</a></p>
<p>若需将RefSeq转存为gtf格式，可参考下列命令：</p>
<pre><code>gunzip refGene.txt.gz
cut -f 2- refGene.txt | genePredToGtf -utr -source=hg38 file stdin refGene.gtf
</code></pre><h2 id="（2）从Table-Browser获取"><a href="#（2）从Table-Browser获取" class="headerlink" title="（2）从Table Browser获取"></a>（2）从Table Browser获取</h2><p>针对annotation，UCSC还通过Table Browser页面</p>
<p><a href="http://genome.ucsc.edu/cgi-bin/hgTables" target="_blank" rel="external">http://genome.ucsc.edu/cgi-bin/hgTables</a></p>
<p>提供了一个更加友好的获取方法。Table Browser的使用基本使用方法可以参考</p>
<p><a href="http://genome.ucsc.edu/goldenPath/help/hgTablesHelp.html#GettingStarted" target="_blank" rel="external">http://genome.ucsc.edu/goldenPath/help/hgTablesHelp.html#GettingStarted</a></p>
<p>为了避免和官方帮助文档的重叠，我仅在这里分享在做REP项目过程中发现的几种比较tricky的用法。</p>
<p>（1）获取GENCODE转录本ID和Gene Symbol的映射</p>
<ul>
<li>clade设置为”Mammal”, genome设置为”Human”，assembly设置为”Dec. 2013 (GRCh38/hg38)”；</li>
<li>将group设置为”Genes and Gene Predictions”，track设置为”All GENCODE V24”；</li>
<li>Table设置为”Basic (wgEncodeGencodeBasicV24)”；</li>
<li>Output format设置为”selected fields from primary and related tables”；</li>
<li>点击”get output”；</li>
<li>在新页面中勾选”name”和”name2”前的复选框；</li>
<li>点击”get output”即可；</li>
</ul>
<p>（2）获取5’UTR/3’ UTR/Coding Exons/Intron的BED文件</p>
<ul>
<li>clade设置为”Mammal”, genome设置为”Human”，assembly设置为”Dec. 2013 (GRCh38/hg38)”；</li>
<li>将group设置为”Genes and Gene Predictions”，track设置为”All GENCODE V24”；</li>
<li>Table设置为”Basic (wgEncodeGencodeBasicV24)”；</li>
<li>Output format设置为”BED – browser extensible data”；</li>
<li>点击”get output”；</li>
<li>在新页面中勾选自己需要的elements；</li>
<li>点击”get BED”即可。</li>
</ul>
<p>（3）获取指定范围的序列</p>
<p>UCSC可以通过使用符合自己需要的注释数据，然后再获取进一步的数据。操作方法如下：</p>
<ul>
<li>点击Table Browser的”add custom tracks”按钮；</li>
<li>在”Paste URLs or data”中添加数据的地址或者使用旁边的文件上传框上传文件，点击”Submit”；</li>
<li>在新页面中选择view in“Table Brower”，点击”go”，这时会跳回Table Browser；</li>
<li>这个时候将region选为“genome”，将Output format设置成”sequence”，结果可以选择“plain text”呈现或者“gzip compressed”下载，点击”get output”即可获取指定范围内的序列。</li>
</ul>
<p>（4）Table Browser使用过程中可能会遇到的问题</p>
<ul>
<li>由于抽取数据脚本执行超时（&gt;10min）或者下载地的网络不佳，下载下来的文件可能会不完整；</li>
<li>获取3’ UTR等序列时，若直接将track指定为系统自带的annotation，会有概率出现序列的start与annotation中不符的情况（0-based和1-based的杂合），建议先下载BED文件，然后通过前述的“获取指定范围的序列”来下载序列。</li>
</ul>
<h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><p><a href="https://support.illumina.com/sequencing/sequencing_software/igenome.html" target="_blank" rel="external"> iGenomes</a></p>
<p>The iGenomes are a collection of reference sequences and annotation files for commonly analyzed organisms. The files have been downloaded from Ensembl, NCBI, or UCSC, and chromosome names have been changed to be simple and consistent with their download source.</p>
<h2 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h2><p>（1）为什么序列分析要repeatmasker：</p>
<p><a href="http://www.dxy.cn/bbs/topic/9424163" target="_blank" rel="external">http://www.dxy.cn/bbs/topic/9424163</a></p>
<p>（2）博耘生物：</p>
<p><a href="http://boyun.sh.cn/bio/?p=1845" target="_blank" rel="external">http://boyun.sh.cn/bio/?p=1845</a></p>
<p>（3）linux进进阶屋：</p>
<p><a href="http://sookk8.blog.51cto.com/455855/328076/" target="_blank" rel="external">http://sookk8.blog.51cto.com/455855/328076/</a></p>
<p>（4）BioDog的博客：</p>
<p><a href="https://www.yaolibio.com/2016/09/01/retrieve-genome-data-from-ucsc/" target="_blank" rel="external">https://www.yaolibio.com/2016/09/01/retrieve-genome-data-from-ucsc/</a></p>
<p>（5）6有才</p>
<p><a href="http://www.jianshu.com/p/542c78a8ee0a" target="_blank" rel="external">http://www.jianshu.com/p/542c78a8ee0a</a></p>
<p>（6）生信宝典</p>
<p><a href="https://mp.weixin.qq.com/s/2OoXy4f1t0hE8OUqsAt1kw" target="_blank" rel="external">https://mp.weixin.qq.com/s/2OoXy4f1t0hE8OUqsAt1kw</a></p>

      
    </div>
    
    
    

    

    

    
	<div>
	
		<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
	
	</div>
    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="https:/AnJingwd.github.io/tags/NGS/" rel="tag"><i class="fa fa-tag"></i> NGS</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="https:/AnJingwd.github.io/2017/08/06/Linux多线程下载工具axel编译安装/" rel="next" title="Linux多线程下载工具axel编译安装">
                <i class="fa fa-chevron-left"></i> Linux多线程下载工具axel编译安装
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="https:/AnJingwd.github.io/2017/08/12/设计sanger测序引物，验证突变位点/" rel="prev" title="设计sanger测序引物，验证突变位点">
                设计sanger测序引物，验证突变位点 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https:/AnJingwd.github.io/images/avatar.png"
               alt="AJ's blog" />
          <p class="site-author-name" itemprop="name">AJ's blog</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="https:/AnJingwd.github.io/archives">
                <span class="site-state-item-count">56</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="https:/AnJingwd.github.io/categories/index.html">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="https:/AnJingwd.github.io/tags/index.html">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="https:/AnJingwd.github.io/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
			 <a title="收藏到书签，偶尔High一下^_^" rel="alternate" class="mw-harlem_shake_slow wobble shake" href='javascript:(function() {
    function c() {
        var e = document.createElement("link");
        e.setAttribute("type", "text/css");
        e.setAttribute("rel", "stylesheet");
        e.setAttribute("href", f);
        e.setAttribute("class", l);
        document.body.appendChild(e)
    }
 
    function h() {
        var e = document.getElementsByClassName(l);
        for (var t = 0; t < e.length; t++) {
            document.body.removeChild(e[t])
        }
    }
 
    function p() {
        var e = document.createElement("div");
        e.setAttribute("class", a);
        document.body.appendChild(e);
        setTimeout(function() {
            document.body.removeChild(e)
        }, 100)
    }
 
    function d(e) {
        return {
            height : e.offsetHeight,
            width : e.offsetWidth
        }
    }
 
    function v(i) {
        var s = d(i);
        return s.height > e && s.height < n && s.width > t && s.width < r
    }
 
    function m(e) {
        var t = e;
        var n = 0;
        while (!!t) {
            n += t.offsetTop;
            t = t.offsetParent
        }
        return n
    }
 
    function g() {
        var e = document.documentElement;
        if (!!window.innerWidth) {
            return window.innerHeight
        } else if (e && !isNaN(e.clientHeight)) {
            return e.clientHeight
        }
        return 0
    }
 
    function y() {
        if (window.pageYOffset) {
            return window.pageYOffset
        }
        return Math.max(document.documentElement.scrollTop, document.body.scrollTop)
    }
 
    function E(e) {
        var t = m(e);
        return t >= w && t <= b + w
    }
 
    function S() {
        var e = document.createElement("audio");
        e.setAttribute("class", l);
        e.src = i;
        e.loop = false;
        e.addEventListener("canplay", function() {
            setTimeout(function() {
                x(k)
            }, 500);
            setTimeout(function() {
                N();
                p();
                for (var e = 0; e < O.length; e++) {
                    T(O[e])
                }
            }, 15500)
        }, true);
        e.addEventListener("ended", function() {
            N();
            h()
        }, true);
        e.innerHTML = " <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";
        document.body.appendChild(e);
        e.play()
    }
 
    function x(e) {
        e.className += " " + s + " " + o
    }
 
    function T(e) {
        e.className += " " + s + " " + u[Math.floor(Math.random() * u.length)]
    }
 
    function N() {
        var e = document.getElementsByClassName(s);
        var t = new RegExp("\\b" + s + "\\b");
        for (var n = 0; n < e.length; ) {
            e[n].className = e[n].className.replace(t, "")
        }
    }
 
    var e = 30;
    var t = 30;
    var n = 350;
    var r = 350;
    var i = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3";
    var s = "mw-harlem_shake_me";
    var o = "im_first";
    var u = ["im_drunk", "im_baked", "im_trippin", "im_blown"];
    var a = "mw-strobe_light";
    var f = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css";
    var l = "mw_added_css";
    var b = g();
    var w = y();
    var C = document.getElementsByTagName("*");
    var k = null;
    for (var L = 0; L < C.length; L++) {
        var A = C[L];
        if (v(A)) {
            if (E(A)) {
                k = A;
                break
            }
        }
    }
    if (A === null) {
        console.warn("Could not find a node of the right size. Please try a different page.");
        return
    }
    c();
    S();
    var O = [];
    for (var L = 0; L < C.length; L++) {
        var A = C[L];
        if (v(A)) {
            O.push(A)
        }
    }
})()'><i class="fa fa-music"></i> High</a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              推荐阅读
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.sina.com.cn/u/1253988497" title="种田农民的博客" target="_blank">种田农民的博客</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.biostars.org/t/Tools/" title="Biostars" target="_blank">Biostars</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://stackoverflow.com/" title="Stack Overflow" target="_blank">Stack Overflow</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://segmentfault.com/" title="SegmentFault" target="_blank">SegmentFault</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.alloyteam.com/nav/" title="Web前端导航" target="_blank">Web前端导航</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.36zhen.com/t?id=3448" title="前端书籍资料" target="_blank">前端书籍资料</a>
                </li>
              
            </ul>
          </div>
        
		
<div id="music163player">		
	<iframe frameborder="no" border="0" 
	marginwidth="0" marginheight="0" width=330 height=86 
src="//music.163.com/outchain/player?type=2&id=471682981&auto=1&height=66">
	</iframe>
</div>	
        

      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#（1）通过Ensembl基因组注释数据库下载"><span class="nav-number">1.</span> <span class="nav-text">（1）通过Ensembl基因组注释数据库下载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基因组序列下载"><span class="nav-number">1.1.</span> <span class="nav-text">基因组序列下载:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#举个栗子"><span class="nav-number">1.2.</span> <span class="nav-text">举个栗子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么要这样做呢？"><span class="nav-number">1.3.</span> <span class="nav-text">为什么要这样做呢？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#除基因组注释文件（GTF或者GFF）下载"><span class="nav-number">1.4.</span> <span class="nav-text">除基因组注释文件（GTF或者GFF）下载</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#确定了需要下载什么后，那如何下载呢？"><span class="nav-number">2.</span> <span class="nav-text">确定了需要下载什么后，那如何下载呢？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（2）通过UCSC下载基因组注释数据"><span class="nav-number">3.</span> <span class="nav-text">（2）通过UCSC下载基因组注释数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（1）从FTP站点获取"><span class="nav-number">4.</span> <span class="nav-text">（1）从FTP站点获取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#（2）从Table-Browser获取"><span class="nav-number">5.</span> <span class="nav-text">（2）从Table Browser获取</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#补充"><span class="nav-number"></span> <span class="nav-text">补充</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#参考："><span class="nav-number">1.</span> <span class="nav-text">参考：</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AJ's blog</span>
</div>


<!--<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>
-->


<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共75.2k字</span>
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  <script type="text/javascript" src="https:/AnJingwd.github.io/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="https:/AnJingwd.github.io/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="https:/AnJingwd.github.io/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="https:/AnJingwd.github.io/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="https:/AnJingwd.github.io/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="https:/AnJingwd.github.io/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="https:/AnJingwd.github.io/lib/three/three.min.js"></script>

  
  <script type="text/javascript" src="https:/AnJingwd.github.io/lib/three/canvas_lines.min.js"></script>


  


  <script type="text/javascript" src="https:/AnJingwd.github.io/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="https:/AnJingwd.github.io/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="https:/AnJingwd.github.io/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="https:/AnJingwd.github.io/js/src/schemes/pisces.js?v=5.1.2"></script>



  
  <script type="text/javascript" src="https:/AnJingwd.github.io/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="https:/AnJingwd.github.io/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="https:/AnJingwd.github.io/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  


</body>
</html>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
